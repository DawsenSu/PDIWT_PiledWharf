#--------------------------------------------------------------------------------------
#    MstnCE  HelloWorld.mke
#--------------------------------------------------------------------------------------
PolicyFile = MicroStationPolicy.mki
DEFAULT_TARGET_PROCESSOR_ARCHITECTURE=x64

appName = MDL_TechTest

appObjs = $(o)$(appName)$(oext) \
			$(o)ElementCreator$(oext) \
			$(o)TechTest$(oext) \
			$(o)ElementsQueryHelper$(oext) \
			$(o)ClickSelectTool$(oext) \


appRscs = $(o)$(appName).rsc $(o)$(appName)Cmd.rsc

baseDir = $(_MakeFilePath)
mdlLibs = $(MSMDE)library/

%include mdl.mki

#----------------------------------------------------------------------
# Create needed output directories if they don't exist
#----------------------------------------------------------------------
always:
    ~mkdir $(o)
    ~mkdir $(rscObjects)
    ~mkdir $(reqdObjs)

#----------------------------------------------------------------------
# Define macros for files included in our link and resource merge
#----------------------------------------------------------------------
DLM_NO_SIGN       = 1
DLM_OBJECT_DEST	  = $(o)
DLM_NAME 	  = $(appName)
DLM_OBJECT_FILES  = $(appObjs)
DLM_NO_DLS	  = 1
DLM_NO_DEF	  = 1
DLM_NOENTRY	  = 1
DLM_NO_MANIFEST   = 1
DLM_DEST	  = $(mdlapps)
LINKER_LIBRARIES = $(mdlLibs)bentley.lib \
	           $(mdlLibs)mdlbltin.lib \
			   $(mdlLibs)RmgrTools.lib \
        	   $(mdlLibs)BentleyGeom.lib \
                   $(mdlLibs)DgnPlatform.lib \
				   $(mdlLibs)BentleyAllocator.lib \
				   $(mdlLibs)DgnView.lib
				   # $(mdlapps)NativeDLL.lib \
				   # $(mdlapps)MixedBridge.lib

#--------------------------------------------
#	Create command table and header file
#--------------------------------------------
$(baseDir)$(appName)cmd.h  : $(baseDir)$(appName)cmd.r

$(o)$(appName)cmd.rsc        : $(baseDir)$(appName)cmd.r

#-----------------------------------------------------------------------
#       Generate resource files
#-----------------------------------------------------------------------
$(o)$(appName).rsc          : $(baseDir)$(appName).r

#----------------------------------------------------------------------
#	Generate MA
#----------------------------------------------------------------------
$(mdlapps)$(appName).ma     : $(appRscs)
        $(msg)
        > $(o)make.opt
        -o$@
        $(appRscs)
        <
        $(RLibCmd) @$(o)make.opt
        ~time

#-----------------------------------------------------------------------------------------
#	Builds any necessary CODE modules and link them to DLL
#-----------------------------------------------------------------------------------------
$(o)$(appName)$(oext)       : $(baseDir)$(appName).cpp		$(baseDir)ClickSelectTool.h		$(baseDir)ElementsQueryHelper.h

$(o)ElementCreator$(oext)	: $(baseDir)ElementCreator.cpp		$(baseDir)ElementCreator.h

$(o)TechTest$(oext)		: $(baseDir)TechTest.cpp		$(baseDir)TechTest.h

$(o)ElementsQueryHelper$(oext)      : $(baseDir)ElementsQueryHelper.cpp		$(baseDir)ElementsQueryHelper.h

$(o)ClickSelectTool$(oext)      : $(baseDir)ClickSelectTool.cpp   $(baseDir)ClickSelectTool.h	$(baseDir)ElementsQueryHelper.h

%include dlmlink.mki

# now there is a line-feed after the last instruction